<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>PT3 Add Entry (API)</title> <style> body { background: #0d0d0d; color: #ffffff; font-family: Arial, sans-serif; padding: 40px; } h1 { text-align: center; letter-spacing: 2px; margin-bottom: 30px; } label { display: block; margin-top: 15px; opacity: 0.8; } input, textarea, select { width: 100%; padding: 10px; margin-top: 6px; background: #1a1a1a; border: none; border-radius: 4px; color: #fff; } textarea { height: 120px; resize: vertical; } button { margin-top: 25px; width: 100%; padding: 12px; background: #0078ff; border: none; border-radius: 4px; color: #fff; font-size: 1.1rem; cursor: pointer; } button:hover { background: #3399ff; } </style> </head> <body> <h1>PT3 — Add Entry</h1> <form id="pt3Form"> <label>Timestamp</label> <input type="text" id="timestamp" placeholder="YYYY-MM-DD HH:MM:SS"> <label>Operator</label> <input type="text" id="operator" placeholder="PT3"> <label>Summary</label> <textarea id="summary"></textarea> <label>Action</label> <textarea id="action"></textarea> <label>Status</label> <select id="status"> <option>Open</option> <option>In Progress</option> <option>Completed</option> <option>Archived</option> </select> <label>Attachments (comma-separated URLs)</label> <input type="text" id="attachments"> <label>GitHub Token</label> <input type="password" id="token" placeholder="Your GitHub PAT"> 
	<button type="button" onclick="submitEntry()">Submit Entry</button>
<button type="button" onclick="submitEntry(true)">Submit + Add Another</button>

	 </form> <script> // Auto-load token + auto-fill timestamp + auto-fill operator document.addEventListener("DOMContentLoaded", () => { const savedToken = localStorage.getItem("pt3_token"); if (savedToken) { document.getElementById("token").value = savedToken; } document.getElementById("timestamp").value = generateTimestamp(); document.getElementById("operator").value = "PT3"; }); // Timestamp generator function generateTimestamp() { const now = new Date(); const year = now.getFullYear(); const month = String(now.getMonth() + 1).padStart(2, "0"); const day = String(now.getDate()).padStart(2, "0"); const hours = String(now.getHours()).padStart(2, "0"); const minutes = String(now.getMinutes()).padStart(2, "0"); const seconds = String(now.getSeconds()).padStart(2, "0"); return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`; } // Submit entry async function submitEntry(addAnother = false) {
 // Refresh timestamp at moment of submission document.getElementById("timestamp").value = generateTimestamp(); const repoOwner = "trippywebhub"; const repoName = "PT3"; const filePath = "pt3.json"; const token = document.getElementById('token').value; // Cache token locally localStorage.setItem("pt3_token", token); const newEntry = { timestamp: document.getElementById('timestamp').value, operator: document.getElementById('operator').value, lane: "PT3", summary: document.getElementById('summary').value, action: document.getElementById('action').value, status: document.getElementById('status').value, attachments: document.getElementById('attachments').value .split(',') .map(a => a.trim()) .filter(a => a.length > 0) }; // STEP 1 — Get existing pt3.json const getRes = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`, { headers: { Authorization: `Bearer ${token}` } }); const fileData = await getRes.json(); const existingContent = JSON.parse(atob(fileData.content)); // STEP 2 — Append new entry existingContent.push(newEntry); // STEP 3 — Encode updated JSON const updatedContent = btoa(JSON.stringify(existingContent, null, 2)); // STEP 4 — Commit back to GitHub const updateRes = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`, { method: "PUT", headers: { Authorization: `Bearer ${token}`, "Content-Type": "application/json" }, body: JSON.stringify({ message: "PT3 entry added via API", content: updatedContent, sha: fileData.sha }) }); if (updateRes.ok) { alert("Entry added successfully!"); // Clear fields after submit document.getElementById('summary').value = ""; document.getElementById('action').value = ""; document.getElementById('attachments').value = ""; document.getElementById('status').value = "Open"; // Refresh timestamp + operator for next entry document.getElementById('timestamp').value = generateTimestamp(); document.getElementById('operator').value = "PT3"; } else { alert("Error adding entry."); } } </script> </body> </html>
 
