<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Home Ops Tile</title>

<style>
    body { margin:0; padding:0; background:#000; font-family:Arial; color:#e5e5e5; overflow:hidden; }
    #container { padding:12px; display:flex; flex-direction:column; gap:10px; }
    .entry { padding:10px 12px; border-radius:6px; background:#0d0d0d; border-left:6px solid #333; box-shadow:0 0 6px rgba(0,0,0,0.6); }
    .timestamp { font-size:12px; color:#888; margin-bottom:3px; }
    .summary { font-size:15px; font-weight:bold; color:#f2f2f2; margin-bottom:3px; }
    .lane { font-size:12px; color:#777; }
    .Open { border-left-color:#ffd60a; }
    .Monitoring { border-left-color:#0a84ff; }
    .Resolved { border-left-color:#32d74b; }
    .Escalated { border-left-color:#ff453a; }
    .LoggedOnly { border-left-color:#8e8e93; }
</style>
</head>

<body>
<div id="container">Loading Home Opsâ€¦</div>

<script>
const LOG_URL = "https://716crewcommand.com/home_ops.json";
const REFRESH_MS = 5000;
const MAX_ENTRIES = 10;

async function loadLog() {
    try {
        const response = await fetch(LOG_URL + "?t=" + Date.now());
        const data = await response.json();

        const container = document.getElementById("container");
        container.innerHTML = "";

        const recent = data.entries.slice(-MAX_ENTRIES).reverse();

        recent.forEach(entry => {
            const div = document.createElement("div");
            const statusClass = entry.status.replace(" ", "");
            div.className = "entry " + statusClass;
            div.innerHTML = `
                <div class="timestamp">${entry.timestamp}</div>
                <div class="summary">${entry.summary}</div>
                <div class="lane">${entry.status}</div>
            `;
            container.appendChild(div);
        });

    } catch (err) {
        document.getElementById("container").innerHTML =
            "<div style='color:#ff453a;'>Error loading lane.</div>";
    }
}

loadLog();
setInterval(loadLog, REFRESH_MS);
</script>

</body>
</html>
